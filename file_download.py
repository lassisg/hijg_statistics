import requests as req
from bs4 import BeautifulSoup
import re


def get_links(url: str, pattern: str) -> list:
    r = req.get(url)
    links = []
    if r.ok:
        soup = BeautifulSoup(r.text, 'html.parser')
        for link in soup.find_all('a', class_=""):
            if re.search(pattern, link.get('href')):
                links.append(link.get('href'))

    else:
        print(r.status_code)

    return links


base = 'http://www.hijg.saude.sc.gov.br'
pattern = '([a-z0-9/.])(-)(estatistica)(s){0,1}-(201)'
website = f"{base}/index.php/indicadores"

links_main = get_links(website, pattern)
links = []
for link_d in links_main:
    links = links + get_links(f"{base}{link_d}", pattern)

for link in links:
    year = link.split('?')[0].split('-')[-1]
    file_name = f"{year}-{link.split(':')[-1]}.pdf"
    file_name = file_name.replace('be', 'boletim-')
    file_name = file_name.replace('rm', 'resumo_mensal_censo-')
    print(f"Downloading file {file_name}")
    myfile = req.get(f'{base}{link}', allow_redirects=True)
    open(f'D:/Desktop/hijg_http/pdf/{file_name}', 'wb').write(myfile.content)

#  '/index.php/indicadores/category/29-estatisticas-2019?download=274:boletim-2019',
#  '/index.php/indicadores/category/29-estatisticas-2019?download=273:censo-geral-2019',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=263:censo-dezembro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=262:boletim-dezembro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=261:censo-novembro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=260:boletim-novembro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=259:censo-outubro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=258:boletim-outubro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=257:boletim-setembro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=256:censo-setembro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=255:boletim-agosto-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=254:censo-agosto-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=253:boletim-julho-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=252:censo-julho-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=251:boletim-junho-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=250:censo-junho-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=248:censo-maio-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=247:boletim-maio-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=246:boletim-abril-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=245:censo-abril-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=244:boletim-marco-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=243:censo-marco-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=242:boletim-fevereiro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=241:censo-fevereiro-2018',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=240:boletim-janeiro',
#  '/index.php/indicadores/category/28-estatisticas-2018?download=239:censo-janeiro-2018',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=238:boletim-dezembro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=237:censo-dezembro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=236:boletim-novembro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=235:censo-novembro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=230:boletim-outubro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=229:censo-novembro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=228:boletim-setembro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=227:censo-setembro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=225:boletim-agosto',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=224:censo-agosto',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=223:censo-julho',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=222:boletim-julho',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=221:censo-junho',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=220:boletim-junho',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=214:censo-maio',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=213:boletim-maio',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=212:censo-abril',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=211:boletim-abril',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=209:censo-marco',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=29:boletim-marco',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=207:censo-fevereiro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=206:boletim-fevereiro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=205:censo-janeiro',
#  '/index.php/indicadores/category/22-estatisticas-2017?download=204:boletim-janeiro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=200:censo-dezembro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=199:boletim-dezembro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=56:censo-novembro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=55:boletim-novembro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=54:censo-outubro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=53:boletim-outubro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=52:censo-setembro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=51:boletim-setembro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=50:censo-agosto',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=49:boletim-agosto',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=48:censo-julho',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=47:boletim-julho',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=46:censo-junho',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=45:boletim-junho',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=44:censo-maio',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=43:boletim-maio',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=42:censo-abril',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=41:boletim-abril',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=40:censo-marco',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=39:boletim-marco',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=38:censo-fevereiro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=37:boletim-fevereiro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=36:censo-janeiro',
#  '/index.php/indicadores/category/20-estatisticas-2016?download=35:boletim-janeiro',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=57:be01',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=58:be02',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=59:be03',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=60:be04',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=61:be05',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=62:be06',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=63:be07',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=64:be08',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=65:be09',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=66:be10',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=67:be11',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=68:be12',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=69:rm01',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=70:rm02',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=71:rm03x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=72:rm04x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=73:rm05x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=74:rm06x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=75:rm07x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=76:rm08x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=77:rm09x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=78:rm10x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=79:rm11x',
#  '/index.php/indicadores/category/19-estatisticas-2015?download=80:rm12x',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=81:be01',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=82:be02',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=83:be03',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=84:be04',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=85:be05',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=86:be06',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=87:be07',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=88:be08',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=89:be09',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=90:be10',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=91:be11',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=92:be12',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=93:rm01',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=94:rm02',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=95:rm03',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=96:rm04',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=97:rm05',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=98:rm06',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=99:rm07',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=100:rm08',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=101:rm09',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=102:rm10',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=103:rm11',
#  '/index.php/indicadores/category/18-estatisticas-2014?download=104:rm12',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=105:be01',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=106:be02',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=107:be03',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=108:be04',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=109:be05',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=110:be06',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=111:be07',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=112:be08',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=113:be09',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=114:be10',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=115:be11',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=116:be12',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=117:rm01',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=118:rm02',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=119:rm03',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=120:rm04',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=121:rm05',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=122:rm06',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=123:rm07',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=124:rm08',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=125:rm09',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=126:rm10',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=127:rm11',
#  '/index.php/indicadores/category/17-estatisticas-2013?download=128:rm12',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=129:be01',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=130:be02',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=131:be03',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=132:be04',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=133:be05',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=134:be06',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=135:be07',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=136:be08',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=137:be09',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=138:be10',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=139:be11',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=140:be12',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=141:rm01',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=142:rm02',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=143:rm03',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=144:rm04',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=145:rm05',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=146:rm06',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=147:rm07',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=148:rm08',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=149:rm09',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=150:rm10',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=151:rm11',
#  '/index.php/indicadores/category/16-estatisticas-2012?download=152:rm12',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=153:be01',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=164:rm01',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=154:be02',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=165:rm02',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=155:be03',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=166:rm03',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=156:be04',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=167:rm04',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=157:be05',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=168:rm05',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=158:be06',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=169:rm06',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=159:be07',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=170:rm07',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=160:be08',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=171:rm08',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=161:be09',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=172:rm09',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=162:be10',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=173:rm10',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=163:be11',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=174:rm11',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=231:be12',
#  '/index.php/indicadores/category/15-estatisticas-2011?download=232:rm12',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=175:be01',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=176:be02',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=177:be03',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=178:be04',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=179:be05',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=180:be06',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=181:be07',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=182:be08',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=183:be09',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=184:be10',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=185:be11',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=186:be12',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=187:rm01',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=188:rm02',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=189:rm03',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=190:rm04',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=191:rm05',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=192:rm06',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=193:rm07',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=194:rm08',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=195:rm09',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=196:rm10',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=197:rm11',
#  '/index.php/indicadores/category/14-estatisticas-2010?download=198:rm12'
